==========================================
SLURM_JOB_ID = 19175585
SLURM_JOB_NODELIST = d11-04
TMPDIR = /tmp/SLURM_19175585
==========================================
2024-02-08 02:26:40,655 : INFO : train.py : Starting training using pytorch version:2.0.1+cu117
2024-02-08 02:26:40,656 : INFO : train.py : CUDA is enabled. Using device_id:0 version:11.7 on gpu:Tesla V100-PCIE-32GB
2024-02-08 02:26:40,658 : INFO : train.py : Building word corpus, requiring minimum word frequency of 20 for dictionary
2024-02-08 02:26:40,754 : INFO : data.py : dataset data/fd_r2_jan_2024_fixed/train.txt, total 109478, unks 12, ratio 0.01%
2024-02-08 02:26:40,759 : INFO : data.py : dataset data/fd_r2_jan_2024_fixed/val.txt, total 13458, unks 6, ratio 0.04%
2024-02-08 02:26:40,764 : INFO : data.py : dataset data/fd_r2_jan_2024_fixed/test.txt, total 13814, unks 0, ratio 0.00%
2024-02-08 02:26:40,764 : INFO : train.py : Building RNN-based dialogue model from word corpus
2024-02-08 02:26:42,054 : INFO : train.py : Training model
2024-02-08 02:26:44,328 : INFO : engine.py : | epoch 001 | train_loss 2.731 | train_ppl 15.352 | s/epoch 2.18 | lr 1.00000000
2024-02-08 02:26:44,328 : INFO : engine.py : | epoch 001 | valid_loss 1.581 | valid_ppl 4.858
2024-02-08 02:26:44,328 : INFO : engine.py : | epoch 001 | valid_select_loss 1.505 | valid_select_ppl 4.505
2024-02-08 02:26:46,388 : INFO : engine.py : | epoch 002 | train_loss 2.124 | train_ppl 8.361 | s/epoch 1.96 | lr 1.00000000
2024-02-08 02:26:46,388 : INFO : engine.py : | epoch 002 | valid_loss 1.281 | valid_ppl 3.602
2024-02-08 02:26:46,388 : INFO : engine.py : | epoch 002 | valid_select_loss 1.502 | valid_select_ppl 4.492
2024-02-08 02:26:48,443 : INFO : engine.py : | epoch 003 | train_loss 1.922 | train_ppl 6.838 | s/epoch 1.96 | lr 1.00000000
2024-02-08 02:26:48,443 : INFO : engine.py : | epoch 003 | valid_loss 1.119 | valid_ppl 3.061
2024-02-08 02:26:48,443 : INFO : engine.py : | epoch 003 | valid_select_loss 1.494 | valid_select_ppl 4.454
2024-02-08 02:26:50,547 : INFO : engine.py : | epoch 004 | train_loss 1.837 | train_ppl 6.281 | s/epoch 2.01 | lr 1.00000000
2024-02-08 02:26:50,547 : INFO : engine.py : | epoch 004 | valid_loss 1.096 | valid_ppl 2.992
2024-02-08 02:26:50,547 : INFO : engine.py : | epoch 004 | valid_select_loss 1.344 | valid_select_ppl 3.834
2024-02-08 02:26:52,660 : INFO : engine.py : | epoch 005 | train_loss 1.694 | train_ppl 5.439 | s/epoch 2.02 | lr 1.00000000
2024-02-08 02:26:52,661 : INFO : engine.py : | epoch 005 | valid_loss 1.064 | valid_ppl 2.898
2024-02-08 02:26:52,661 : INFO : engine.py : | epoch 005 | valid_select_loss 1.080 | valid_select_ppl 2.944
2024-02-08 02:26:54,724 : INFO : engine.py : | epoch 006 | train_loss 1.586 | train_ppl 4.882 | s/epoch 1.97 | lr 1.00000000
2024-02-08 02:26:54,724 : INFO : engine.py : | epoch 006 | valid_loss 1.054 | valid_ppl 2.870
2024-02-08 02:26:54,724 : INFO : engine.py : | epoch 006 | valid_select_loss 1.057 | valid_select_ppl 2.877
2024-02-08 02:26:56,807 : INFO : engine.py : | epoch 007 | train_loss 1.554 | train_ppl 4.728 | s/epoch 1.99 | lr 1.00000000
2024-02-08 02:26:56,807 : INFO : engine.py : | epoch 007 | valid_loss 1.083 | valid_ppl 2.954
2024-02-08 02:26:56,807 : INFO : engine.py : | epoch 007 | valid_select_loss 0.974 | valid_select_ppl 2.649
2024-02-08 02:26:58,873 : INFO : engine.py : | epoch 008 | train_loss 1.546 | train_ppl 4.693 | s/epoch 1.97 | lr 1.00000000
2024-02-08 02:26:58,874 : INFO : engine.py : | epoch 008 | valid_loss 1.059 | valid_ppl 2.884
2024-02-08 02:26:58,874 : INFO : engine.py : | epoch 008 | valid_select_loss 0.982 | valid_select_ppl 2.670
2024-02-08 02:27:00,960 : INFO : engine.py : | epoch 009 | train_loss 1.519 | train_ppl 4.567 | s/epoch 2.00 | lr 1.00000000
2024-02-08 02:27:00,961 : INFO : engine.py : | epoch 009 | valid_loss 1.045 | valid_ppl 2.845
2024-02-08 02:27:00,961 : INFO : engine.py : | epoch 009 | valid_select_loss 0.881 | valid_select_ppl 2.414
2024-02-08 02:27:02,989 : INFO : engine.py : | epoch 010 | train_loss 1.475 | train_ppl 4.372 | s/epoch 1.93 | lr 1.00000000
2024-02-08 02:27:02,989 : INFO : engine.py : | epoch 010 | valid_loss 1.027 | valid_ppl 2.792
2024-02-08 02:27:02,989 : INFO : engine.py : | epoch 010 | valid_select_loss 0.824 | valid_select_ppl 2.280
2024-02-08 02:27:05,076 : INFO : engine.py : | epoch 011 | train_loss 1.452 | train_ppl 4.273 | s/epoch 1.99 | lr 1.00000000
2024-02-08 02:27:05,076 : INFO : engine.py : | epoch 011 | valid_loss 1.018 | valid_ppl 2.769
2024-02-08 02:27:05,076 : INFO : engine.py : | epoch 011 | valid_select_loss 0.798 | valid_select_ppl 2.220
2024-02-08 02:27:07,076 : INFO : engine.py : | epoch 012 | train_loss 1.435 | train_ppl 4.199 | s/epoch 1.90 | lr 1.00000000
2024-02-08 02:27:07,076 : INFO : engine.py : | epoch 012 | valid_loss 1.025 | valid_ppl 2.788
2024-02-08 02:27:07,076 : INFO : engine.py : | epoch 012 | valid_select_loss 0.796 | valid_select_ppl 2.217
2024-02-08 02:27:09,134 : INFO : engine.py : | epoch 013 | train_loss 1.419 | train_ppl 4.132 | s/epoch 1.96 | lr 1.00000000
2024-02-08 02:27:09,135 : INFO : engine.py : | epoch 013 | valid_loss 1.010 | valid_ppl 2.747
2024-02-08 02:27:09,135 : INFO : engine.py : | epoch 013 | valid_select_loss 0.875 | valid_select_ppl 2.399
2024-02-08 02:27:11,221 : INFO : engine.py : | epoch 014 | train_loss 1.413 | train_ppl 4.106 | s/epoch 1.99 | lr 1.00000000
2024-02-08 02:27:11,221 : INFO : engine.py : | epoch 014 | valid_loss 1.026 | valid_ppl 2.790
2024-02-08 02:27:11,221 : INFO : engine.py : | epoch 014 | valid_select_loss 0.742 | valid_select_ppl 2.101
2024-02-08 02:27:13,284 : INFO : engine.py : | epoch 015 | train_loss 1.385 | train_ppl 3.995 | s/epoch 1.97 | lr 1.00000000
2024-02-08 02:27:13,284 : INFO : engine.py : | epoch 015 | valid_loss 1.005 | valid_ppl 2.733
2024-02-08 02:27:13,284 : INFO : engine.py : | epoch 015 | valid_select_loss 0.729 | valid_select_ppl 2.072
2024-02-08 02:27:15,340 : INFO : engine.py : | epoch 016 | train_loss 1.376 | train_ppl 3.960 | s/epoch 1.96 | lr 1.00000000
2024-02-08 02:27:15,340 : INFO : engine.py : | epoch 016 | valid_loss 1.000 | valid_ppl 2.719
2024-02-08 02:27:15,340 : INFO : engine.py : | epoch 016 | valid_select_loss 0.845 | valid_select_ppl 2.327
2024-02-08 02:27:17,406 : INFO : engine.py : | epoch 017 | train_loss 1.352 | train_ppl 3.863 | s/epoch 1.97 | lr 1.00000000
2024-02-08 02:27:17,406 : INFO : engine.py : | epoch 017 | valid_loss 0.992 | valid_ppl 2.697
2024-02-08 02:27:17,406 : INFO : engine.py : | epoch 017 | valid_select_loss 0.735 | valid_select_ppl 2.085
2024-02-08 02:27:19,531 : INFO : engine.py : | epoch 018 | train_loss 1.298 | train_ppl 3.664 | s/epoch 2.03 | lr 1.00000000
2024-02-08 02:27:19,532 : INFO : engine.py : | epoch 018 | valid_loss 1.048 | valid_ppl 2.853
2024-02-08 02:27:19,532 : INFO : engine.py : | epoch 018 | valid_select_loss 0.573 | valid_select_ppl 1.773
2024-02-08 02:27:21,599 : INFO : engine.py : | epoch 019 | train_loss 1.239 | train_ppl 3.452 | s/epoch 1.97 | lr 1.00000000
2024-02-08 02:27:21,599 : INFO : engine.py : | epoch 019 | valid_loss 1.002 | valid_ppl 2.723
2024-02-08 02:27:21,599 : INFO : engine.py : | epoch 019 | valid_select_loss 0.425 | valid_select_ppl 1.529
2024-02-08 02:27:23,679 : INFO : engine.py : | epoch 020 | train_loss 1.163 | train_ppl 3.200 | s/epoch 1.98 | lr 1.00000000
2024-02-08 02:27:23,680 : INFO : engine.py : | epoch 020 | valid_loss 0.986 | valid_ppl 2.681
2024-02-08 02:27:23,680 : INFO : engine.py : | epoch 020 | valid_select_loss 0.327 | valid_select_ppl 1.387
2024-02-08 02:27:25,755 : INFO : engine.py : | epoch 021 | train_loss 1.122 | train_ppl 3.071 | s/epoch 1.98 | lr 1.00000000
2024-02-08 02:27:25,755 : INFO : engine.py : | epoch 021 | valid_loss 0.986 | valid_ppl 2.681
2024-02-08 02:27:25,755 : INFO : engine.py : | epoch 021 | valid_select_loss 0.284 | valid_select_ppl 1.328
2024-02-08 02:27:27,814 : INFO : engine.py : | epoch 022 | train_loss 1.103 | train_ppl 3.012 | s/epoch 1.96 | lr 1.00000000
2024-02-08 02:27:27,814 : INFO : engine.py : | epoch 022 | valid_loss 1.032 | valid_ppl 2.807
2024-02-08 02:27:27,814 : INFO : engine.py : | epoch 022 | valid_select_loss 0.305 | valid_select_ppl 1.357
2024-02-08 02:27:29,868 : INFO : engine.py : | epoch 023 | train_loss 1.085 | train_ppl 2.958 | s/epoch 1.96 | lr 1.00000000
2024-02-08 02:27:29,868 : INFO : engine.py : | epoch 023 | valid_loss 1.013 | valid_ppl 2.753
2024-02-08 02:27:29,868 : INFO : engine.py : | epoch 023 | valid_select_loss 0.257 | valid_select_ppl 1.293
2024-02-08 02:27:31,966 : INFO : engine.py : | epoch 024 | train_loss 1.075 | train_ppl 2.929 | s/epoch 2.00 | lr 1.00000000
2024-02-08 02:27:31,966 : INFO : engine.py : | epoch 024 | valid_loss 0.988 | valid_ppl 2.687
2024-02-08 02:27:31,966 : INFO : engine.py : | epoch 024 | valid_select_loss 0.174 | valid_select_ppl 1.190
2024-02-08 02:27:34,040 : INFO : engine.py : | epoch 025 | train_loss 1.054 | train_ppl 2.870 | s/epoch 1.98 | lr 1.00000000
2024-02-08 02:27:34,040 : INFO : engine.py : | epoch 025 | valid_loss 0.981 | valid_ppl 2.668
2024-02-08 02:27:34,040 : INFO : engine.py : | epoch 025 | valid_select_loss 0.175 | valid_select_ppl 1.192
2024-02-08 02:27:36,102 : INFO : engine.py : | epoch 026 | train_loss 1.050 | train_ppl 2.858 | s/epoch 1.97 | lr 1.00000000
2024-02-08 02:27:36,102 : INFO : engine.py : | epoch 026 | valid_loss 0.986 | valid_ppl 2.679
2024-02-08 02:27:36,102 : INFO : engine.py : | epoch 026 | valid_select_loss 0.168 | valid_select_ppl 1.183
2024-02-08 02:27:38,072 : INFO : engine.py : | epoch 027 | train_loss 1.037 | train_ppl 2.820 | s/epoch 1.87 | lr 1.00000000
2024-02-08 02:27:38,072 : INFO : engine.py : | epoch 027 | valid_loss 1.029 | valid_ppl 2.798
2024-02-08 02:27:38,072 : INFO : engine.py : | epoch 027 | valid_select_loss 0.336 | valid_select_ppl 1.399
2024-02-08 02:27:39,999 : INFO : engine.py : | epoch 028 | train_loss 1.035 | train_ppl 2.816 | s/epoch 1.83 | lr 1.00000000
2024-02-08 02:27:39,999 : INFO : engine.py : | epoch 028 | valid_loss 1.000 | valid_ppl 2.718
2024-02-08 02:27:39,999 : INFO : engine.py : | epoch 028 | valid_select_loss 0.119 | valid_select_ppl 1.126
2024-02-08 02:27:42,082 : INFO : engine.py : | epoch 029 | train_loss 1.026 | train_ppl 2.790 | s/epoch 1.99 | lr 1.00000000
2024-02-08 02:27:42,083 : INFO : engine.py : | epoch 029 | valid_loss 0.991 | valid_ppl 2.693
2024-02-08 02:27:42,083 : INFO : engine.py : | epoch 029 | valid_select_loss 0.067 | valid_select_ppl 1.069
2024-02-08 02:27:44,093 : INFO : engine.py : | epoch 030 | train_loss 1.019 | train_ppl 2.771 | s/epoch 1.92 | lr 1.00000000
2024-02-08 02:27:44,093 : INFO : engine.py : | epoch 030 | valid_loss 0.976 | valid_ppl 2.653
2024-02-08 02:27:44,093 : INFO : engine.py : | epoch 030 | valid_select_loss 0.100 | valid_select_ppl 1.105
2024-02-08 02:27:44,093 : INFO : engine.py : | start annealing | best validselectloss 0.067 | best validselectppl 1.069
2024-02-08 02:27:46,127 : INFO : engine.py : | epoch 031 | train_loss 0.972 | train_ppl 2.643 | s/epoch 1.94 | lr 0.20000000
2024-02-08 02:27:46,127 : INFO : engine.py : | epoch 031 | valid_loss 0.944 | valid_ppl 2.570
2024-02-08 02:27:46,127 : INFO : engine.py : | epoch 031 | valid_select_loss 0.078 | valid_select_ppl 1.081
2024-02-08 02:27:48,139 : INFO : engine.py : | epoch 032 | train_loss 0.959 | train_ppl 2.608 | s/epoch 1.92 | lr 0.04000000
2024-02-08 02:27:48,139 : INFO : engine.py : | epoch 032 | valid_loss 0.940 | valid_ppl 2.561
2024-02-08 02:27:48,139 : INFO : engine.py : | epoch 032 | valid_select_loss 0.080 | valid_select_ppl 1.083
2024-02-08 02:27:48,140 : INFO : train.py : final select_ppl 1.083
SELFISH
2024-02-08 02:27:52,234 : INFO : reinforce.py : Starting training using pytorch version:2.0.1+cu117
2024-02-08 02:27:52,235 : INFO : reinforce.py : CUDA is enabled. Using device_id:0 version:11.7 on gpu:Tesla V100-PCIE-32GB
2024-02-08 02:27:53,632 : INFO : reinforce.py : Creating RlAgent from alice_model: ../logs/jan24_casino_custformat_supervised_30ep_fixed.pt
2024-02-08 02:27:53,633 : INFO : reinforce.py : Creating Bob's (not --smart_bob) LstmAgent
2024-02-08 02:27:53,751 : INFO : reinforce.py : Initializing communication dialogue between Alice and Bob
2024-02-08 02:27:53,791 : INFO : reinforce.py : Building word corpus, requiring minimum word frequency of 20 for dictionary
2024-02-08 02:27:53,890 : INFO : reinforce.py : Starting Reinforcement Learning
2024-02-08 02:27:54,805 : INFO : reinforce.py : Num: 10
2024-02-08 02:27:55,747 : INFO : reinforce.py : Num: 20
2024-02-08 02:27:56,667 : INFO : reinforce.py : Num: 30
2024-02-08 02:27:57,661 : INFO : reinforce.py : Num: 40
2024-02-08 02:27:58,437 : INFO : reinforce.py : Num: 50
2024-02-08 02:27:59,201 : INFO : reinforce.py : Num: 60
2024-02-08 02:28:00,001 : INFO : reinforce.py : Num: 70
2024-02-08 02:28:00,746 : INFO : reinforce.py : Num: 80
2024-02-08 02:28:01,610 : INFO : reinforce.py : Num: 90
2024-02-08 02:28:02,417 : INFO : reinforce.py : Num: 100
Namespace(data='data/fd_r2_jan_2024_fixed', unk_threshold=20, alice_model_file='../logs/jan24_casino_custformat_supervised_30ep_fixed.pt', bob_model_file='../logs/jan24_casino_custformat_supervised_30ep_fixed.pt', output_model_file='../logs/jan24_casino_custform_rl_selfish_4ep_fixed.pt', context_file='data/fd_r2_jan_2024_fixed/selfplay.txt', temperature=0.5, cuda=True, verbose=False, seed=1, score_threshold=6, log_file='', smart_bob=False, gamma=0.95, eps=0.0, nesterov=True, momentum=0.1, lr=0.5, clip=1.0, rl_lr=0.2, rl_clip=1.0, ref_text='data/fd_r2_jan_2024_fixed/train.txt', bsz=16, sv_train_freq=4, nepoch=4, visual=False, domain='object_division', scale_rw=1.0, rw_type='own_points')
[['smalltalk', '<eos>'], ['smalltalk', '<eos>'], ['smalltalk', '<eos>'], ['elicitpreference', '<eos>'], ['expresspreference', 'firewood', '<eos>'], ['expresspreference', 'water', 'firewood', '<eos>'], ['expresspreference', 'firewood', 'water', '<eos>'], ['noneed', 'food', 'expresspreference', 'water', 'propose', 'food=0', 'water=3', 'firewood=0', '<eos>'], ['propose', 'food=0', 'water=3', 'firewood=3', '<eos>'], ['<selection>']]
88888888888888888888888888888888888888888888888888888888888888888888888888888888
[['item0=3', 'item1=3', 'item2=0', 'item0=0', 'item1=0', 'item2=3'], ['item0=0', 'item1=3', 'item2=3', 'item0=3', 'item1=0', 'item2=0']]
Failure
[['smalltalk', '<eos>'], ['smalltalk', '<eos>'], ['elicitpreference', '<eos>'], ['expresspreference', 'water', '<eos>'], ['expresspreference', 'firewood', '<eos>'], ['expresspreference', 'water', '<eos>'], ['propose', 'food=0', 'water=2', 'firewood=3', '<eos>'], ['propose', 'food=3', 'water=1', 'firewood=0', '<eos>'], ['propose', 'food=3', 'water=1', 'firewood=3', '<eos>'], ['agree', '<eos>'], ['<selection>']]
88888888888888888888888888888888888888888888888888888888888888888888888888888888
[['item0=0', 'item1=1', 'item2=3', 'item0=3', 'item1=2', 'item2=0'], ['item0=0', 'item1=2', 'item2=0', 'item0=3', 'item1=1', 'item2=3']]
Failure
100: dialog_len=12.76 sent_len=3.24 agree=100.00% advantage=2.69 time=0.079s comb_rew=37.08 alice_rew=19.89 alice_sel=51.00% alice_unique=102 bob_rew=17.19 bob_sel=49.00% bob_unique=101 full_match=0.98
2024-02-08 02:28:02,528 : INFO : reinforce.py : 100: dialog_len=12.76 sent_len=3.24 agree=100.00% advantage=2.69 time=0.079s comb_rew=37.08 alice_rew=19.89 alice_sel=51.00% alice_unique=102 bob_rew=17.19 bob_sel=49.00% bob_unique=101 full_match=0.98
2024-02-08 02:28:03,259 : INFO : reinforce.py : Num: 110
2024-02-08 02:28:03,980 : INFO : reinforce.py : Num: 120
2024-02-08 02:28:04,828 : INFO : reinforce.py : Num: 130
2024-02-08 02:28:05,600 : INFO : reinforce.py : Num: 140
[['smalltalk', '<eos>'], ['smalltalk', '<eos>'], ['smalltalk', '<eos>'], ['unknown', '<eos>'], ['elicitpreference', '<eos>'], ['expresspreference', 'firewood', '<eos>'], ['expresspreference', 'firewood', '<eos>'], ['elicitpreference', 'firewood', '<eos>'], ['propose', 'food=2', '<eos>'], ['expresspreference', 'firewood', '<eos>'], ['propose', 'food=1', 'water=1', 'firewood=1', '<eos>'], ['expresspreference', 'firewood', '<eos>'], ['propose', 'food=1', 'water=1', 'firewood=1', '<eos>'], ['expresspreference', 'firewood', '<eos>'], ['propose', 'food=1', '<eos>'], ['<selection>']]
88888888888888888888888888888888888888888888888888888888888888888888888888888888
[['item0=2', 'item1=1', 'item2=2', 'item0=1', 'item1=2', 'item2=1'], ['item0=1', 'item1=1', 'item2=1', 'item0=2', 'item1=2', 'item2=2']]
Failure
[['elicitpreference', '<eos>'], ['propose', 'food=1', 'water=2', 'firewood=2', '<eos>'], ['noneed', 'firewood', 'expresspreference', 'water', 'food', '<eos>'], ['noneed', 'firewood', 'expresspreference', 'water', '<eos>'], ['elicitpreference', 'firewood', '<eos>'], ['expresspreference', 'water', '<eos>'], ['propose', 'water=2', '<eos>'], ['expresspreference', 'water', '<eos>'], ['propose', 'food=3', 'water=2', 'firewood=0', '<eos>'], ['propose', 'food=1', 'water=2', 'firewood=2', '<eos>'], ['propose', 'water=2', '<eos>'], ['agree', '<eos>'], ['<selection>']]
88888888888888888888888888888888888888888888888888888888888888888888888888888888
[['item0=2', 'item1=2', 'item2=1', 'item0=1', 'item1=1', 'item2=2'], ['item0=1', 'item1=2', 'item2=2', 'item0=2', 'item1=1', 'item2=1']]
Failure
final: train_loss 1.025 train_ppl 2.787
final: train_select_loss 0.011 train_select_ppl 1.011
final: valid_loss 1.040 valid_ppl 2.829
final: valid_select_loss 0.077 valid_select_ppl 1.080
final: dialog_len=12.84 sent_len=3.23 agree=100.00% advantage=3.38 time=0.078s comb_rew=37.04 alice_rew=20.21 alice_sel=63.89% alice_unique=113 bob_rew=16.83 bob_sel=36.11% bob_unique=122 full_match=0.99
2024-02-08 02:28:06,645 : INFO : reinforce.py : Saving updated Alice model to ../logs/jan24_casino_custform_rl_selfish_4ep_fixed_rw_own_points.pt
FAIR
2024-02-08 02:28:10,333 : INFO : reinforce.py : Starting training using pytorch version:2.0.1+cu117
2024-02-08 02:28:10,334 : INFO : reinforce.py : CUDA is enabled. Using device_id:0 version:11.7 on gpu:Tesla V100-PCIE-32GB
2024-02-08 02:28:11,711 : INFO : reinforce.py : Creating RlAgent from alice_model: ../logs/jan24_casino_custformat_supervised_30ep_fixed.pt
2024-02-08 02:28:11,711 : INFO : reinforce.py : Creating Bob's (not --smart_bob) LstmAgent
2024-02-08 02:28:11,817 : INFO : reinforce.py : Initializing communication dialogue between Alice and Bob
2024-02-08 02:28:11,821 : INFO : reinforce.py : Building word corpus, requiring minimum word frequency of 20 for dictionary
2024-02-08 02:28:11,911 : INFO : reinforce.py : Starting Reinforcement Learning
2024-02-08 02:28:12,888 : INFO : reinforce.py : Num: 10
2024-02-08 02:28:13,967 : INFO : reinforce.py : Num: 20
2024-02-08 02:28:14,797 : INFO : reinforce.py : Num: 30
2024-02-08 02:28:15,694 : INFO : reinforce.py : Num: 40
2024-02-08 02:28:16,541 : INFO : reinforce.py : Num: 50
2024-02-08 02:28:17,334 : INFO : reinforce.py : Num: 60
2024-02-08 02:28:18,130 : INFO : reinforce.py : Num: 70
2024-02-08 02:28:18,944 : INFO : reinforce.py : Num: 80
2024-02-08 02:28:19,715 : INFO : reinforce.py : Num: 90
2024-02-08 02:28:20,492 : INFO : reinforce.py : Num: 100
Namespace(data='data/fd_r2_jan_2024_fixed', unk_threshold=20, alice_model_file='../logs/jan24_casino_custformat_supervised_30ep_fixed.pt', bob_model_file='../logs/jan24_casino_custformat_supervised_30ep_fixed.pt', output_model_file='../logs/jan24_casino_custform_rl_fair_4ep_fixed.pt', context_file='data/fd_r2_jan_2024_fixed/selfplay.txt', temperature=0.5, cuda=True, verbose=False, seed=1, score_threshold=6, log_file='', smart_bob=False, gamma=0.95, eps=0.0, nesterov=True, momentum=0.1, lr=0.5, clip=1.0, rl_lr=0.2, rl_clip=1.0, ref_text='data/fd_r2_jan_2024_fixed/train.txt', bsz=16, sv_train_freq=4, nepoch=4, visual=False, domain='object_division', scale_rw=1.0, rw_type='combine50_50')
[['smalltalk', '<eos>'], ['smalltalk', '<eos>'], ['smalltalk', '<eos>'], ['elicitpreference', '<eos>'], ['noneed', 'food', 'expresspreference', 'water', '<eos>'], ['expresspreference', 'water', 'firewood', '<eos>'], ['noneed', 'food', 'expresspreference', 'water', 'firewood', '<eos>'], ['propose', 'food=2', 'water=1', '<eos>'], ['agree', '<eos>'], ['unknown', '<eos>'], ['agree', '<eos>'], ['<selection>']]
88888888888888888888888888888888888888888888888888888888888888888888888888888888
[['item0=1', 'item1=2', 'item2=2', 'item0=2', 'item1=1', 'item2=1'], ['item0=2', 'item1=1', 'item2=0', 'item0=1', 'item1=2', 'item2=3']]
Failure
[['smalltalk', '<eos>'], ['smalltalk', '<eos>'], ['smalltalk', '<eos>'], ['smalltalk', '<eos>'], ['smalltalk', '<eos>'], ['expresspreference', 'water', '<eos>'], ['unknown', '<eos>'], ['smalltalk', '<eos>'], ['unknown', '<eos>'], ['smalltalk', '<eos>'], ['<selection>']]
88888888888888888888888888888888888888888888888888888888888888888888888888888888
[['item0=0', 'item1=2', 'item2=1', 'item0=3', 'item1=1', 'item2=2'], ['item0=3', 'item1=2', 'item2=1', 'item0=0', 'item1=1', 'item2=2']]
Failure
[['smalltalk', '<eos>'], ['smalltalk', '<eos>'], ['smalltalk', '<eos>'], ['smalltalk', '<eos>'], ['unknown', '<eos>'], ['expresspreference', 'firewood', '<eos>'], ['propose', 'water=1', '<eos>'], ['agree', '<eos>'], ['agree', '<eos>'], ['agree', '<eos>'], ['agree', '<eos>'], ['<selection>']]
88888888888888888888888888888888888888888888888888888888888888888888888888888888
[['item0=1', 'item1=1', 'item2=1', 'item0=2', 'item1=2', 'item2=2'], ['item0=1', 'item1=2', 'item2=2', 'item0=2', 'item1=1', 'item2=1']]
Failure
[['smalltalk', '<eos>'], ['smalltalk', '<eos>'], ['smalltalk', '<eos>'], ['smalltalk', '<eos>'], ['smalltalk', '<eos>'], ['smalltalk', '<eos>'], ['smalltalk', '<eos>'], ['expresspreference', 'water', '<eos>'], ['expresspreference', 'water', '<eos>'], ['smalltalk', '<eos>'], ['smalltalk', '<eos>'], ['<selection>']]
88888888888888888888888888888888888888888888888888888888888888888888888888888888
[['item0=0', 'item1=2', 'item2=1', 'item0=3', 'item1=1', 'item2=2'], ['item0=0', 'item1=2', 'item2=1', 'item0=3', 'item1=1', 'item2=2']]
Failure
[['smalltalk', '<eos>'], ['smalltalk', '<eos>'], ['smalltalk', '<eos>'], ['smalltalk', '<eos>'], ['smalltalk', '<eos>'], ['smalltalk', '<eos>'], ['smalltalk', '<eos>'], ['smalltalk', '<eos>'], ['smalltalk', '<eos>'], ['smalltalk', '<eos>'], ['smalltalk', '<eos>'], ['smalltalk', '<eos>'], ['<selection>']]
88888888888888888888888888888888888888888888888888888888888888888888888888888888
[['item0=0', 'item1=1', 'item2=2', 'item0=3', 'item1=2', 'item2=1'], ['item0=3', 'item1=1', 'item2=1', 'item0=0', 'item1=2', 'item2=2']]
Failure
[['smalltalk', '<eos>'], ['smalltalk', '<eos>'], ['smalltalk', '<eos>'], ['elicitpreference', '<eos>'], ['expresspreference', 'water', '<eos>'], ['expresspreference', 'food', '<eos>'], ['elicitpreference', 'food', '<eos>'], ['expresspreference', 'food', '<eos>'], ['propose', 'food=0', 'water=2', '<eos>'], ['agree', '<eos>'], ['<selection>']]
88888888888888888888888888888888888888888888888888888888888888888888888888888888
[['item0=3', 'item1=1', 'item2=0', 'item0=0', 'item1=2', 'item2=3'], ['item0=0', 'item1=2', 'item2=2', 'item0=3', 'item1=1', 'item2=1']]
Failure
[['smalltalk', '<eos>'], ['smalltalk', '<eos>'], ['elicitpreference', '<eos>'], ['expresspreference', 'food', '<eos>'], ['noneed', 'firewood', 'expresspreference', 'food', 'propose', 'food=3', '<eos>'], ['propose', 'food=0', 'firewood=3', '<eos>'], ['smalltalk', '<eos>'], ['smalltalk', '<eos>'], ['smalltalk', '<eos>'], ['<selection>']]
88888888888888888888888888888888888888888888888888888888888888888888888888888888
[['item0=3', 'item1=2', 'item2=0', 'item0=0', 'item1=1', 'item2=3'], ['item0=0', 'item1=2', 'item2=3', 'item0=3', 'item1=1', 'item2=0']]
Failure
100: dialog_len=12.90 sent_len=3.08 agree=100.00% advantage=0.00 time=0.082s comb_rew=37.44 alice_rew=18.72 alice_sel=20.00% alice_unique=98 bob_rew=18.72 bob_sel=80.00% bob_unique=88 full_match=0.99
2024-02-08 02:28:20,593 : INFO : reinforce.py : 100: dialog_len=12.90 sent_len=3.08 agree=100.00% advantage=0.00 time=0.082s comb_rew=37.44 alice_rew=18.72 alice_sel=20.00% alice_unique=98 bob_rew=18.72 bob_sel=80.00% bob_unique=88 full_match=0.99
2024-02-08 02:28:21,423 : INFO : reinforce.py : Num: 110
2024-02-08 02:28:22,254 : INFO : reinforce.py : Num: 120
2024-02-08 02:28:23,044 : INFO : reinforce.py : Num: 130
2024-02-08 02:28:23,892 : INFO : reinforce.py : Num: 140
[['smalltalk', '<eos>'], ['smalltalk', '<eos>'], ['smalltalk', '<eos>'], ['elicitpreference', '<eos>'], ['expresspreference', 'food', '<eos>'], ['expresspreference', 'water', '<eos>'], ['smalltalk', '<eos>'], ['smalltalk', '<eos>'], ['smalltalk', '<eos>'], ['<selection>']]
88888888888888888888888888888888888888888888888888888888888888888888888888888888
[['item0=3', 'item1=2', 'item2=1', 'item0=0', 'item1=1', 'item2=2'], ['item0=3', 'item1=1', 'item2=1', 'item0=0', 'item1=2', 'item2=2']]
Failure
final: train_loss 1.011 train_ppl 2.748
final: train_select_loss 0.025 train_select_ppl 1.025
final: valid_loss 1.011 valid_ppl 2.748
final: valid_select_loss 0.152 valid_select_ppl 1.165
final: dialog_len=12.69 sent_len=3.09 agree=100.00% advantage=0.00 time=0.080s comb_rew=37.37 alice_rew=18.68 alice_sel=29.17% alice_unique=121 bob_rew=18.68 bob_sel=70.83% bob_unique=109 full_match=0.99
2024-02-08 02:28:24,900 : INFO : reinforce.py : Saving updated Alice model to ../logs/jan24_casino_custform_rl_fair_4ep_fixed_rw_combine50_50.pt
